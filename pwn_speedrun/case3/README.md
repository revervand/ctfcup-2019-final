# Pwn speedrun | Case3

## Информация

> Для окончательно победой над арбалетами нам нужно получить доступ ко всем оставшимся сервисам.
> 
> Мы обнаружили множество простых сетевых сервисов, думаю ты быстро справишься.
> 
> `nc <ip> 33047`
>
> `flag in /tmp/flag.txt`

## Запуск

Отдать командам бинарник из deploy/static и ip-адрес сервера

```sh
cd deploy
docker-compose -p speedrun_pwn_case3 up --build -d 
```


## Описание

ELF 64bit, C, no strip, no pack

Суть задания - проэксплуатировать уязвимость форматной строки

## Решение

1. Сливаем адрес libc (функция __libc_start_main)
2. Перезаписываем puts в GOT на функция с уязвимостью
3. Вторым пейлоадом перезаписываем puts в GOT на one_gadget

[Пример эксплоита](solve/exploit.py)


## Флаг

`Cup{be6b4065d4c73ff1ec819c63d442f8c6245315b7fef8a4bd28077cb55d05ccd7}`