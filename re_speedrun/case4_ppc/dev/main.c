#include "main.h"

// Cup{f522cac768c5755f3d3cef64388a1ebf96a091b5bcbc4797b159140704895f81}

BYTE hash_0[SHA256_BLOCK_SIZE] = {0xb6,0x2c,0x68,0x17,0x38,0xd1,0x33,0x45,0xb4,0x6a,0x2b,0xdd,0x1d,0x93,0xae,0x25,0x1d,0x1d,0xcd,0x65,0xf6,0xb,0x83,0xb6,0x34,0x3a,0xc3,0x35,0x35,0x73,0x8f,0xdb};
BYTE hash_1[SHA256_BLOCK_SIZE] = {0x7f,0xee,0x87,0xb4,0xc5,0xc3,0x82,0x70,0xb0,0x2,0xab,0x24,0xd9,0x1,0x10,0x4a,0xbe,0x3,0x74,0x86,0xc7,0xd,0xf,0x82,0x8d,0xd2,0x8f,0x24,0x87,0x91,0x59,0xdd};
BYTE hash_2[SHA256_BLOCK_SIZE] = {0xb6,0xe1,0x28,0x85,0x27,0xa6,0x3,0x2c,0xf,0x29,0xc9,0xda,0x2c,0x59,0x92,0x2,0xcc,0x25,0xf,0xb4,0x4,0xe4,0x78,0x38,0x20,0xd4,0xce,0xb,0x9,0x45,0x99,0x89};
BYTE hash_3[SHA256_BLOCK_SIZE] = {0x78,0x5f,0x3e,0xc7,0xeb,0x32,0xf3,0xb,0x90,0xcd,0xf,0xcf,0x36,0x57,0xd3,0x88,0xb5,0xff,0x42,0x97,0xf2,0xf9,0x71,0x6f,0xf6,0x6e,0x9b,0x69,0xc0,0x5d,0xdd,0x9};
BYTE hash_4[SHA256_BLOCK_SIZE] = {0x69,0x59,0x9,0x70,0x1,0xd1,0x5,0x1,0xac,0x7d,0x54,0xc0,0xbd,0xb8,0xdb,0x61,0x42,0xf,0x65,0x8f,0x29,0x22,0xcc,0x26,0xe4,0x6d,0x53,0x61,0x19,0xa3,0x11,0x26};
BYTE hash_5[SHA256_BLOCK_SIZE] = {0xf2,0x8d,0x5b,0xd,0x6f,0x8b,0xe0,0xda,0x84,0x46,0xda,0xbe,0x79,0x4,0x4c,0xb9,0xed,0xf,0xfa,0x31,0x50,0xa0,0x3,0x93,0x61,0x55,0x40,0x9f,0xe7,0x78,0xb8,0x85};
BYTE hash_6[SHA256_BLOCK_SIZE] = {0xa2,0x18,0x55,0xda,0x8,0xcb,0x10,0x2d,0x1d,0x21,0x7c,0x53,0xdc,0x58,0x24,0xa3,0xa7,0x95,0xc1,0xc1,0xa4,0x4e,0x97,0x1b,0xf0,0x1a,0xb9,0xda,0x3a,0x2a,0xcb,0xbf};
BYTE hash_7[SHA256_BLOCK_SIZE] = {0xd0,0xbf,0x3e,0x6e,0xe1,0xd6,0x68,0xde,0x18,0xc9,0xca,0x20,0xa,0x4f,0x15,0x20,0x62,0xf3,0x45,0x28,0x3e,0xe6,0x8c,0xad,0xfe,0x41,0x20,0x4f,0x21,0x5d,0x75,0xe9};
BYTE hash_8[SHA256_BLOCK_SIZE] = {0xf3,0x69,0xcb,0x89,0xfc,0x62,0x7e,0x66,0x89,0x87,0x0,0x7d,0x12,0x1e,0xd1,0xea,0xcd,0xc0,0x1d,0xb9,0xe2,0x8f,0x8b,0xb2,0x6f,0x35,0x8b,0x7d,0x8c,0x4f,0x8,0xac};
BYTE hash_9[SHA256_BLOCK_SIZE] = {0x6,0xcd,0xed,0xe1,0x98,0xbc,0x96,0xa5,0x94,0xf1,0x68,0x5f,0xcd,0xc2,0xf7,0xb3,0xf3,0x9a,0x45,0x4a,0xc9,0x7d,0x70,0xa,0x1c,0x63,0xb2,0xbc,0x2,0xcd,0x75,0xe1};
BYTE hash_10[SHA256_BLOCK_SIZE] = {0xda,0x5,0x68,0xa2,0x52,0x9,0xc7,0x65,0x52,0x2,0x6c,0x3b,0x87,0xac,0x37,0x4a,0xcd,0x8e,0x8a,0xea,0xfc,0x6,0x1e,0x4,0xac,0x55,0xfa,0xc1,0x8c,0x45,0xcb,0x2d};
BYTE hash_11[SHA256_BLOCK_SIZE] = {0xf3,0xa0,0xcf,0x50,0xce,0xa6,0xb3,0xdf,0x2d,0xfe,0xb5,0x2b,0xd1,0x85,0x59,0xad,0xcd,0x50,0x77,0x37,0xce,0x73,0xac,0xa6,0x40,0xa0,0x59,0x6d,0xd4,0x67,0x5a,0x46};
BYTE hash_12[SHA256_BLOCK_SIZE] = {0x4c,0xa6,0x69,0xac,0x37,0x13,0xd1,0xf4,0xae,0xa0,0x7d,0xae,0x8d,0xcc,0xd,0x1c,0x98,0x67,0xd2,0x7e,0xa8,0x2a,0x3b,0xa4,0xe6,0x15,0x8a,0x42,0x20,0x6f,0x95,0x9b};
BYTE hash_13[SHA256_BLOCK_SIZE] = {0xa6,0x8b,0x41,0x2c,0x42,0x82,0x55,0x5f,0x15,0x54,0x6c,0xf6,0xe1,0xfc,0x42,0x89,0x3b,0x7e,0x7,0xf2,0x71,0x55,0x7c,0xeb,0x2,0x18,0x21,0x9,0x8d,0xd6,0x6c,0x1b};
BYTE hash_14[SHA256_BLOCK_SIZE] = {0xae,0xa9,0x21,0x32,0xc4,0xcb,0xeb,0x26,0x3e,0x6a,0xc2,0xbf,0x6c,0x18,0x3b,0x5d,0x81,0x73,0x7f,0x17,0x9f,0x21,0xef,0xdc,0x58,0x63,0x73,0x96,0x72,0xf0,0xf4,0x70};
BYTE hash_15[SHA256_BLOCK_SIZE] = {0x92,0xda,0x40,0x82,0x2,0x2a,0x8e,0x51,0x2c,0x95,0x84,0x17,0x93,0x20,0xaf,0x9d,0xf5,0x9a,0x6a,0xe1,0x55,0x54,0x94,0x22,0x50,0xc3,0x72,0x4b,0xba,0xbf,0x7,0xc7};
BYTE hash_16[SHA256_BLOCK_SIZE] = {0xa8,0x19,0x6a,0x36,0xf4,0xd7,0x36,0xa5,0x40,0xdf,0xf9,0xa8,0xa0,0x3,0x87,0x11,0x1f,0xf0,0x13,0x3f,0x98,0x48,0xf4,0xe1,0x49,0x11,0x80,0x92,0xac,0x71,0x24,0x26};
BYTE hash_17[SHA256_BLOCK_SIZE] = {0x4,0xe5,0xdd,0xb5,0xf5,0x97,0xea,0xd2,0x40,0x95,0x0,0x33,0xa6,0x97,0xc3,0x42,0xcb,0xb8,0x4a,0x3c,0x55,0x0,0xc3,0x2,0x41,0x2,0x48,0x30,0x60,0xcf,0xdf,0x59};
BYTE hash_18[SHA256_BLOCK_SIZE] = {0x7b,0x1a,0x27,0x8f,0x5a,0xbe,0x8e,0x9d,0xa9,0x7,0xfc,0x9c,0x29,0xdf,0xd4,0x32,0xd6,0xd,0xc7,0x6e,0x17,0xb0,0xfa,0xba,0xb6,0x59,0xd2,0xa5,0x8,0xbc,0x65,0xc4};
BYTE hash_19[SHA256_BLOCK_SIZE] = {0x4e,0x11,0x95,0xdf,0x2,0xd,0xe5,0x9e,0xd,0x65,0xa3,0x3a,0x42,0x79,0xf1,0x18,0x3e,0x7a,0xe4,0xe5,0xd9,0x80,0xe3,0x9,0xf8,0xb5,0x5a,0xdf,0xf2,0xe6,0x1c,0x3e};
BYTE hash_20[SHA256_BLOCK_SIZE] = {0x1d,0xa5,0x1b,0x8d,0x8f,0xf9,0x8f,0x6a,0x48,0xf8,0xa,0xe7,0x9f,0xe3,0xca,0x6c,0x26,0xe1,0xab,0xb7,0xb7,0xd1,0x25,0x25,0x92,0x55,0xd6,0xd2,0xb8,0x75,0xea,0x8};
BYTE hash_21[SHA256_BLOCK_SIZE] = {0x3c,0x56,0x61,0x97,0x49,0x42,0x37,0x96,0x14,0xb9,0x43,0xd0,0x59,0x3e,0x4a,0x5e,0x3f,0x85,0x90,0xa,0xb3,0xfb,0x4c,0xe0,0x64,0x72,0x5c,0x15,0xcc,0xb9,0x3a,0x1};
BYTE hash_22[SHA256_BLOCK_SIZE] = {0x1e,0xb,0xbd,0x6c,0x68,0x6b,0xa0,0x50,0xb8,0xeb,0x3,0xff,0xee,0xdc,0x64,0xfd,0xc9,0xd8,0x9,0x47,0xfc,0xe8,0x21,0xab,0xbe,0x5d,0x6d,0xc8,0xd2,0x52,0xc5,0xac};
BYTE hash_23[SHA256_BLOCK_SIZE] = {0x1e,0xb,0xbd,0x6c,0x68,0x6b,0xa0,0x50,0xb8,0xeb,0x3,0xff,0xee,0xdc,0x64,0xfd,0xc9,0xd8,0x9,0x47,0xfc,0xe8,0x21,0xab,0xbe,0x5d,0x6d,0xc8,0xd2,0x52,0xc5,0xac};
BYTE hash_24[SHA256_BLOCK_SIZE] = {0x31,0x48,0x90,0x56,0xe0,0x91,0x6d,0x59,0xfe,0x3a,0xdd,0x79,0xe6,0x3f,0x9,0x5a,0xf3,0xff,0xb8,0x16,0x4,0x69,0x1f,0x21,0xca,0xd4,0x42,0xa8,0x5c,0x7b,0xe6,0x17};
BYTE hash_25[SHA256_BLOCK_SIZE] = {0xd6,0xd8,0x24,0xab,0xba,0x4a,0xfd,0xe8,0x11,0x29,0xc7,0x1d,0xea,0x75,0xb8,0x10,0xe,0x96,0x33,0x8d,0xa5,0xf4,0x16,0xd2,0xf6,0x90,0x88,0xf1,0x96,0xc,0xb0,0x91};
BYTE hash_26[SHA256_BLOCK_SIZE] = {0x7d,0xc9,0x6f,0x77,0x6c,0x84,0x23,0xe5,0x7a,0x27,0x85,0x48,0x9a,0x3f,0x9c,0x43,0xfb,0x6e,0x75,0x68,0x76,0xd6,0xad,0x9a,0x9c,0xac,0x4a,0xa4,0xe7,0x2e,0xc1,0x93};
BYTE hash_27[SHA256_BLOCK_SIZE] = {0x3e,0x1e,0x96,0x7e,0x9b,0x79,0x3e,0x90,0x8f,0x8e,0xae,0x83,0xc7,0x4d,0xba,0x9b,0xcc,0xcc,0xe6,0xa5,0x53,0x5b,0x4b,0x46,0x2b,0xd9,0x99,0x45,0x37,0xbf,0xe1,0x5c};
BYTE hash_28[SHA256_BLOCK_SIZE] = {0x85,0x27,0xa8,0x91,0xe2,0x24,0x13,0x69,0x50,0xff,0x32,0xca,0x21,0x2b,0x45,0xbc,0x93,0xf6,0x9f,0xbb,0x80,0x1c,0x3b,0x1e,0xbe,0xda,0xc5,0x27,0x75,0xf9,0x9e,0x61};
BYTE hash_29[SHA256_BLOCK_SIZE] = {0x19,0xb1,0x0,0xab,0x77,0x25,0xc6,0x12,0xf3,0xd8,0xf,0xf2,0x3,0xca,0x53,0xce,0xa5,0xca,0xda,0xaf,0xae,0x3b,0xf0,0xf8,0x8f,0xf,0xb4,0x8,0x9f,0xe0,0x88,0x15};
BYTE hash_30[SHA256_BLOCK_SIZE] = {0x6c,0xd5,0xb6,0xe5,0x19,0x36,0xa4,0x42,0xb9,0x73,0x66,0xc,0x21,0x55,0x3d,0xd2,0x2b,0xd7,0x2d,0xdc,0x87,0x51,0x13,0x2a,0x94,0x34,0x75,0x28,0x81,0x13,0xb4,0xc0};
BYTE hash_31[SHA256_BLOCK_SIZE] = {0xcd,0x70,0xbe,0xa0,0x23,0xf7,0x52,0xa0,0x56,0x4a,0xbb,0x6e,0xd0,0x8d,0x42,0xc1,0x44,0xf,0x2e,0x33,0xe2,0x99,0x14,0xe5,0x5e,0xb,0xe1,0x59,0x5e,0x24,0xf4,0x5a};
BYTE hash_32[SHA256_BLOCK_SIZE] = {0x6,0xcd,0xed,0xe1,0x98,0xbc,0x96,0xa5,0x94,0xf1,0x68,0x5f,0xcd,0xc2,0xf7,0xb3,0xf3,0x9a,0x45,0x4a,0xc9,0x7d,0x70,0xa,0x1c,0x63,0xb2,0xbc,0x2,0xcd,0x75,0xe1};
BYTE hash_33[SHA256_BLOCK_SIZE] = {0x53,0x16,0xca,0x1c,0x5d,0xdc,0xa8,0xe6,0xce,0xcc,0xfc,0xe5,0x8f,0x3b,0x85,0x40,0xe5,0x40,0xee,0x22,0xf6,0x18,0xf,0xb8,0x94,0x92,0x90,0x40,0x51,0xb3,0xd5,0x31};
BYTE hash_34[SHA256_BLOCK_SIZE] = {0xd1,0xb,0x36,0xaa,0x74,0xa5,0x9b,0xcf,0x4a,0x88,0x18,0x58,0x37,0xf6,0x58,0xaf,0xaf,0x36,0x46,0xef,0xf2,0xbb,0x16,0xc3,0x92,0x8d,0xe,0x93,0x35,0xe9,0x45,0xd2};


BYTE* hashes[ 35 ] = {&hash_0[0],&hash_1[0],&hash_2[0],&hash_3[0],
	&hash_4[0],&hash_5[0],&hash_6[0],&hash_7[0],&hash_8[0],
	&hash_9[0],&hash_10[0],&hash_11[0],&hash_12[0],&hash_13[0],
	&hash_14[0],&hash_15[0],&hash_16[0],&hash_17[0],&hash_18[0],
	&hash_19[0],&hash_20[0],&hash_21[0],&hash_22[0],&hash_23[0],
	&hash_24[0],&hash_25[0],&hash_26[0],&hash_27[0],&hash_28[0],
	&hash_29[0],&hash_30[0],&hash_31[0],&hash_32[0],&hash_33[0],
	&hash_34[0]
};


int main()
{
	setup();

	char* buf = (char*) malloc( 70 );

	printf( "{?} Enter token: " );
	int nbytes = read( 0, buf, 70 );
	buf[ nbytes - 1 ] = '\0';


	for ( int i = 0, j = 0; i < 68; i += 2, j++ )
	{
		const BYTE part[ 2 ] = {buf[ i ], buf[ i + 1 ]};
		

		BYTE buf[ SHA256_BLOCK_SIZE ];
		SHA256_CTX ctx;

		int idx;
		int pass = 1;

		sha256_init( &ctx );
		sha256_update( &ctx, &part[0], 2 );
		sha256_final( &ctx, buf );

		pass = pass && !memcmp( hashes[j], buf, SHA256_BLOCK_SIZE );

		if ( pass != 1 )
		{
			puts( "{-} Invalid flag!" );
			return -1;
		}
	}

	puts( "{+} Valid flag!" );
	return 1;
}

void setup( void )
{
	setvbuf( stdout, 0, 2, 0 );
  	setvbuf( stderr, 0, 2, 0 );
  	setvbuf( stdin,  0, 2, 0 );
};